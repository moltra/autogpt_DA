{"url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765", "repository_url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT", "labels_url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765/labels{/name}", "comments_url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765/comments", "events_url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765/events", "html_url": "https://github.com/Significant-Gravitas/Auto-GPT/pull/765", "id": 1661719629, "node_id": "PR_kwDOJKSTjM5N-9pt", "number": 765, "title": "\ud83d\ude80 REST API: AGI can Create, Start and Stop multiple Autonomous Agents (Monitoring coming soon)\ud83d\ude80", "user": {"login": "merwanehamadi", "id": 9652976, "node_id": "MDQ6VXNlcjk2NTI5NzY=", "avatar_url": "https://avatars.githubusercontent.com/u/9652976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/merwanehamadi", "html_url": "https://github.com/merwanehamadi", "followers_url": "https://api.github.com/users/merwanehamadi/followers", "following_url": "https://api.github.com/users/merwanehamadi/following{/other_user}", "gists_url": "https://api.github.com/users/merwanehamadi/gists{/gist_id}", "starred_url": "https://api.github.com/users/merwanehamadi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/merwanehamadi/subscriptions", "organizations_url": "https://api.github.com/users/merwanehamadi/orgs", "repos_url": "https://api.github.com/users/merwanehamadi/repos", "events_url": "https://api.github.com/users/merwanehamadi/events{/privacy}", "received_events_url": "https://api.github.com/users/merwanehamadi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 5381931159, "node_id": "LA_kwDOJKSTjM8AAAABQMnAlw", "url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/labels/needs%20discussion", "name": "needs discussion", "color": "0e8a16", "default": false, "description": "To be discussed among maintainers"}, {"id": 5400185961, "node_id": "LA_kwDOJKSTjM8AAAABQeBMaQ", "url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/labels/conflicts", "name": "conflicts", "color": "FBCA04", "default": false, "description": "Automatically applied to PRs with merge conflicts"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 21, "created_at": "2023-04-11T03:42:51Z", "updated_at": "2023-04-22T23:26:09Z", "closed_at": null, "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/pulls/765", "html_url": "https://github.com/Significant-Gravitas/Auto-GPT/pull/765", "diff_url": "https://github.com/Significant-Gravitas/Auto-GPT/pull/765.diff", "patch_url": "https://github.com/Significant-Gravitas/Auto-GPT/pull/765.patch", "merged_at": null}, "body": "<!-- \ud83d\udce2 Announcement\r\nWe've recently noticed an increase in pull requests focusing on combining multiple changes. While the intentions behind these PRs are appreciated, it's essential to maintain a clean and manageable git history. To ensure the quality of our repository, we kindly ask you to adhere to the following guidelines when submitting PRs:\r\n\r\nFocus on a single, specific change.\r\nDo not include any unrelated or \"extra\" modifications.\r\nProvide clear documentation and explanations of the changes made.\r\nEnsure diffs are limited to the intended lines \u2014 no applying preferred formatting styles or line endings (unless that's what the PR is about).\r\nFor guidance on committing only the specific lines you have changed, refer to this helpful video: https://youtu.be/8-hSNHHbiZg\r\n\r\nBy following these guidelines, your PRs are more likely to be merged quickly after testing, as long as they align with the project's overall direction. -->\r\n\r\n### Background\r\nThe goal is to build an AGI. This AGI might be one single Auto-GPT that loops against itself, but I doubt it because the LLM is super slow. We can't expect to have something that has high computing power with only one autonomous agent. And we can't have one agent per computing machine, that's stupid, because most of the time the running process will just hang and do nothing, waiting for Open AI to give back an answer. Waste of resources. Running multiple agents in different tabs is not ideal either because processes are heavier than threads.\r\nOn the current PR I was able to spawn 20 concurrent workers simultaneously without any problem.\r\n\r\nSo I think that in order to build an AGI, we need to build an entity able to:\r\n- Define autonomous agents.\r\n- Start autonomous agents\r\n- Monitor autonomous agents. This means being able to identify all the meaningful events happening to them and talk to them. (this is not part of this PR unfortunately, it's too many changes at once, but I have a branch ready for it) => \r\n- Stop these workers when necessary.\r\n\r\nWhich programmatic language is the AGI going to use to do that? A proper, well-defined REST API is the way to go, we can only do so much with a CLI.\r\n\r\nThis AGI will talk to its workers through rest api calls, which are nothing more than JSON sent over the network.\r\n\r\nAt the beginning we will be playing the AGI, so we will use these endpoints to communicate with our agents, through a web browser UI.\r\n\r\n### Changes\r\nNow let's come back to reality, I had to work with what the repo provides, so I made the smallest changes possible to achieve these goals. **The first thing I want to say, is that my changes won't affect the users in any way. All the existing features are preserved and unchanged.**\r\n\r\nAdditions to the repo **that are all necessary to achieve this User Story** (I insist they're all necessary to be merged together):\r\n- A well-structured web server with FastAPI.\r\n- Solid integration tests, extremely readable because all the expected requests and responses are written. These integration tests record the behavior of the autonomous agents. I will use these tests to maintain an automatically generated documentation of auto-gpt api. \r\n- The integration tests work with GPT3.5 and the cost is very small. Talking about cost, @Torantulino please create an online bank account for auto-gpt organization so we can wire money and pay for an api key that will use to call open AI within github action. You can keep the key private. I will wire 100$ to the bank account when you have it ready. Also, I know some companies interested sponsoring auto-gpt, so reach out to me on discord.\r\n- Ability to stop an autonomous agent gracefully, without forcing it. Each agent runs in separates threads.\r\n- a NoMemory class. Why is that ? Because right now memories are shared accross the same worker !!! So it means if we spawn multiple autonomous agents, they will step into each other's toes. The great news is that NoMemory is actually super performant, I have tested it and it performs oftentimes better than pinecone, mostly because we load an ugly JSON of all the past memories and it confuses the AI. Particularly with GPT 3.5. It turns out summarizing the content as we go and loosing any non essential information can be great for short tasks.\r\n- the server is currently in a folder called app with the right project structure for a project of this size. This was the easiest way to do it without breaking the whole repo. This repo has no module, and I can't put the api under a folder called \"scripts\", that's beyond me :)\r\n\r\nCHANGES to the repo:\r\n- finally wrap the main.py into an \"if ___main___\", otherwise nothing in this project is reusable, right now I can't import the main.py without starting the loop haha\r\n- create the autonomous agent class so that it can start the start_loop method\r\n- create attributes of the class. It's pretty much adding self everywhere.\r\n- The temperature is currently None in the repo which means 1. The values are between 0 and 2. For my tests I need a very consistent LLM, so I need 0. So I just put an environment variable. The value will still be 1 for others and nothing changes. (I recommend putting the default value to 0 by the way this is a game changer, but that's another story...)\r\n\r\n### Documentation\r\nLook at the tests, they document clearly the following requests and responses as well as the output of the worker:\r\n2 integration tests at the moment: \r\n- Autonomous agent defined (POST), started (PATCH) STOPPED immediately after starting (PATCH)\r\n- Autonomous agent defined (POST), started (PATCH), Writes a file and shuts down on its own. When we try to shut it down we get a 500 because it's already down.\r\n![Screenshot 2023-04-10 at 8 32 34 PM](https://user-images.githubusercontent.com/9652976/231049456-95d0950e-8996-4766-a61a-1fe0f5cb9999.png)\r\n![Screenshot 2023-04-10 at 8 32 29 PM](https://user-images.githubusercontent.com/9652976/231049458-55217c4c-ead9-4e15-a5fb-89a83cb428f5.png)\r\n![Screenshot 2023-04-10 at 8 32 24 PM](https://user-images.githubusercontent.com/9652976/231049459-ba1fc769-2b78-49e9-99e6-1bcf25dba8c4.png)\r\n![Screenshot 2023-04-10 at 8 32 16 PM](https://user-images.githubusercontent.com/9652976/231049461-ca10c4ff-95a2-41d8-9cd6-223b26c94e33.png)\r\n\r\n\r\n\r\n\r\n### Test Plan\r\nThe CLI has to keep working !!! So I tested it thoroughly Here is one run example.\r\n<img width=\"1492\" alt=\"Screenshot 2023-04-10 at 8 27 02 PM\" src=\"https://user-images.githubusercontent.com/9652976/231049559-304ab597-704f-44a1-8715-4d5ef560052c.png\">\r\n<img width=\"1491\" alt=\"Screenshot 2023-04-10 at 8 27 12 PM\" src=\"https://user-images.githubusercontent.com/9652976/231049569-332316fe-07a8-4c95-99db-c9fb9de46541.png\">\r\n### PR Quality Checklist\r\n- [X] My pull request is atomic and focuses on a single change.\r\n- [X] I have thouroughly tested my changes with multiple different prompts.\r\n- [X] I have considered potential risks and mitigations for my changes.\r\n- [X] I have documented my changes clearly and comprehensively.\r\n- [X] I have not snuck in any \"extra\" small tweaks changes <!-- Submit these as seperate Pull Reqests, they are the easiest to merge! -->\r\n\r\n<!-- If you haven't added tests, please explain why. If you have, check the appropriate box. If you've ensured your PR is atomic and well-documented, check the corresponding boxes. -->\r\n\r\n<!-- By submitting this, I agree that my pull request should be closed if I do not fill this out or follow the guide lines. -->\r\n", "reactions": {"url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765/reactions", "total_count": 75, "+1": 29, "-1": 0, "laugh": 7, "hooray": 7, "confused": 0, "heart": 10, "rocket": 13, "eyes": 9}, "timeline_url": "https://api.github.com/repos/Significant-Gravitas/Auto-GPT/issues/765/timeline", "performed_via_github_app": null, "state_reason": null}